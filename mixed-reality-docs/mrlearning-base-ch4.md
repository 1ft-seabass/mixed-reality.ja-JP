---
title: MR 学習ベース モジュール - 3D オブジェクトの操作
description: ''
author: jessemcculloch
ms.author: jemccull
ms.date: 05/02/2019
ms.topic: article
keywords: Mixed Reality、Unity、チュートリアル、Hololens
ms.openlocfilehash: d47f2940ad741cb436322a824a67f54bb6376c55
ms.sourcegitcommit: b0b1b8e1182cce93929d409706cdaa99ff24fdee
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/23/2019
ms.locfileid: "68387694"
---
# <a name="5-interacting-with-3d-objects"></a>5。3D オブジェクトとの対話

このチュートリアルでは、基本的な3D コンテンツとユーザーエクスペリエンスについて説明します。 次の情報について説明します。 
* コレクションの一部として3D オブジェクトを整理する。
* 基本操作のための境界ボックス。
* Near と遠くのやり取り。
* ハンドトラッキングを使用したタッチジェスチャとグラブジェスチャ。 

## <a name="objectives"></a>目的

* MRTK の grid オブジェクトコレクションで3D コンテンツを整理する方法について説明します。
* 境界ボックスを実装する
* 基本的な操作のための3D オブジェクトの構成--移動、回転、およびスケール
* 近距離操作と遠距離操作について確認する
* グラブやタッチなど、その他のハンドトラッキングジェスチャについて説明します。

## <a name="instructions"></a>手順

### <a name="organizing-3d-objects-in-a-collection"></a>3D オブジェクトをコレクションに整理する

1. 階層を右クリックし、[空の作成] を選択します。 これにより、空のゲーム オブジェクトが作成されます。 名前を3DObjectCollection に変更します。 ここに、すべての 3 D オブジェクトを保存します。 コレクションの位置が x = 0、y = 0、z = 0 に設定されていることを確認します。

![Lesson4 Chapter1 Step1im](images/Lesson4_Chapter1_step1im.PNG)

2. [レッスン1から](mrlearning-base-ch1.md)に記載されているカスタムパッケージをインポートする場合と同じ手順を使用して、basemodule アセットをインポートします。 BaseModule アセットには、このチュートリアル全体で使用される3D モジュールとその他の便利なスクリプトが含まれています。 BaseModule Unity パッケージは次の場所にあります。<https://github.com/Microsoft/MixedRealityLearning/releases/tag/V1.1>

3. コーヒー カップのプレハブは、その横にある青色の立方体で見分けることができます。 Blue cube や small ホワイトペーパーではコーヒーカップを選択しないでください。これは、事前 fab ではなく元の3D モデルを表しているためです)。 

![Lesson4 Chapter1 Noteaim](images/Lesson4_chapter1_noteaim.PNG)

4. 選択したコーヒーカップ prefab を、手順1で作成した 3DObjectCollection game オブジェクトにドラッグします。 これでコーヒー カップはコレクションの子になりました。

![Lesson4 Chapter1 Step4ima](images/Lesson4_chapter1_step4ima.PNG)

5. 次に、シーンに 3 D オブジェクトを追加します。 この例で追加するオブジェクトの一覧を以下に示します。 オブジェクトを追加すると、さまざまなサイズのシーンにオブジェクトが表示されることがあります。 [インスペクター] パネルの [変換] 設定で、各3D モデルのスケールを調整します。 この例で推奨される調整とそのオブジェクトを以下に示します。 プロジェクトパネルの [検索] ボックスでこれらの単語を検索し、3D オブジェクトの prefab を前の手順と同様に3DObjectCollection オブジェクトにドラッグします。 これらの prefabs のコレクションは、> BaseModuleAssets > Base Module Prefabs にあります。
- TheModule_BaseModuleIncomplete を検索します。 シーン内にドラッグします。 スケールを x = 0.03、y = 0.03、z = 0.03 に設定します。 
- Octa_BaseModuleIncomplete を検索します。 シーン内にドラッグします。 スケールを x = 0.13、 y = 0.13、z =0.13 に設定します。
- EarthCore_BaseModuleIncomplete を検索します。 シーン内にドラッグします。 スケールを x = 50.0、y = 50.0、z = 50.0 に設定します。
- Cheese_BaseModuleIncomplete を検索します。 シーン内にドラッグします。 スケールを x = 0.05、y = 0.05、z = 0.05 に設定します。
- Model_Platonic_BaseModuleIncomplete を検索します。 シーン内にドラッグします。 スケールを x = 0.13、y = 0.13、z = 0.13 に設定します。

![Lesson4 Chapter1 Step5im](images/Lesson4_Chapter1_step5im.PNG)

6. シーンに3つのキューブを追加します。 3DObjectCollection オブジェクトを右クリックし、[3D オブジェクト]、[キューブ] の順に選択します。 スケールを x = 0.14、y = 0.14、z = 0.14 に設定します。 合計3つのキューブを作成するには、この手順をさらに2回繰り返します。 または、キューブを合計3つのキューブに対して2回複製することもできます。 また、[アセット] > [BaseModuleAssets] > [ベース モジュール プレハブ] から用意されている 3 つの立方体のプレハブを使用し、GreenCube_BaseModuleIncomplete、BlueCube_BaseModuleIncomplete、および OrangeCube_BaseModuleIncomplete を選択することもできます。

![Lesson4 Chapter1 Step6im](images/Lesson4_Chapter1_step6im.PNG)

7. MRTK の Grid Object Collection を使用して、[レッスン 2](mrlearning-base-ch2.md) で説明した手順で、オブジェクトのコレクションを整理してグリッドを形成します。 3x3 グリッドでのオブジェクトの構成例については、次の図を参照してください。

![Lesson4 Chapter1 Notebim](images/Lesson4_chapter1_notebim.PNG)

>注:上の図のように、一部のオブジェクトはセンター外にあることがわかります。 これは、プレハブまたはオブジェクトに整列していない子オブジェクトが含まれている可能性があるためです。 オブジェクトの位置や子オブジェクトの位置に必要な調整を自由に加えることで、グリッドを適切に整列させることができます。


### <a name="manipulating-3d-objects"></a>3D オブジェクトの操作
1. 立方体を操作する機能を追加します。 3D オブジェクトを操作する機能を追加するには、次の手順を実行します。
-   階層内で操作する3D オブジェクト (つまり、キューブの1つ) を選択します。
-   [コンポーネントの追加] をクリックします。 
-   操作を検索します。
-   操作ハンドラーを選択します。
-   3DObjectCollection オブジェクトの下にあるすべての3D オブジェクトに対して繰り返しますが、3DObjectCollection 自体は同じではありません。
-   すべての3D オブジェクトに collider または box collider があることを確認します (コンポーネント > Box Collider を追加します)。

![Lesson4 Chapter2 Step1im](images/Lesson4_chapter2_step1im.PNG)

>操作ハンドラーは、操作時にオブジェクトがどのように動作するかの設定を調整できるコンポーネントです。 これには、特定の軸での回転、拡大縮小、移動、制約の移動が含まれます。 

2. 1 つの立方体を、拡大縮小しかできないように制限します。 3DObjectCollection オブジェクトで1つのキューブを選択します。 [インスペクター] パネルで、[2 つのきき操作の種類] の横にあるドロップダウンメニューをクリックし、[スケール] を選択します。 これにより、ユーザーは立方体のサイズしか変更できなくなります。

![Lesson4 Chapter2 Step2im](images/Lesson4_Chapter2_step2im.PNG)

3. 立方体を区別できるように、それぞれの色を変更します。 
-   [プロジェクト] パネルに移動し、MixedRealityToolkit が表示されるまで下にスクロールして、それを選択します。
-   [Standard Assets] フォルダーを選択します。
-   [素材] フォルダーをクリックします。
-   立方体のそれぞれに異なる素材をドラッグします。 

>注:立方体には任意の色を選択できます。 この例では、glowingcyan、glowingorange、および green を使用します。 さまざまな色を自由に試すことができます。 キューブに色を追加するには、変更するキューブをクリックし、その素材をキューブの [インスペクター] パネルのメッシュレンダラーの [素材] フィールドにドラッグします。 

![Lesson4 Chapter2 Step3im](images/Lesson4_Chapter2_step3im.PNG)

4. 3DObjectCollection オブジェクト内の別のキューブを選択し、その移動を先頭からの固定距離に制限するように設定します。 これを行うには、[移動] ラベルの [制約] の右側にあるドロップダウンメニューをクリックし、[ヘッドからの距離を修正] を選択します。 これにより、ユーザーは視野内でしか立方体を動かせなくなります。 

![Lesson4 Chapter2 Step4im](images/Lesson4_chapter2_step4im.PNG)

次のいくつかの手順の目的は、3D オブジェクトをグラブして操作し、さまざまな操作設定を適用できるようにすることです。

5. [チーズ] オブジェクトを選択し、[インスペクター] パネルの [コンポーネントの追加] をクリックします。 

6. [検索] ボックスで [Near Grabbable] を検索し、スクリプトを選択します。 このコンポーネントを使用すると、ユーザーは追跡したハンドを使用してオブジェクトを取得できます。 次の画像の緑色の円で示されているように、[Far 操作を許可する] チェックボックスをオフにしない限り、オブジェクトを距離から操作することもできます。

![Lesson4 Chapter2 Step6im](images/Lesson4_Chapter2_step6im.PNG)

7. これらのオブジェクトに対して手順 5. と 6. を繰り返して、プラトニックオブジェクト、地球コア、旧暦モジュール、およびコーヒーカップに Near Grabbable を追加します。

8. Octa オブジェクトから遠距離操作ができないようにします。 これを行うには、階層内で Octa を選択し、[far 操作を許可する] チェックボックスをオフにします (緑色の円でマークされています)。 これにより、ユーザーは、Octa を追跡対象の手で直接操作することしかできなくなります。

>注:操作ハンドラーのコンポーネントとそれに関連する設定の詳細なドキュメントについては、[MRTK のドキュメント](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/README_ManipulationHandler.html)を参照してください。

9. Near の相互作用 Grabbable コンポーネントが、地球コア、太陰暦モジュール、およびコーヒーカップに追加されていることを確認します (手順7を参照)。

10. 旧暦モジュールの場合は、次の図に示すように、操作ハンドラーの設定を変更して、オブジェクトの中心に対して近距離と遠の両方の操作を回転させます。

![Lesson4 Chapter2 Step10im](images/Lesson4_chapter2_step10im.PNG)

11:地球コアの場合は、リリース動作を何も変更しません。 これにより、地球コアがユーザーのつかみから解放されると、移動は続行されません。 

![Lesson4 Chapter2 Step11im](images/Lesson4_Chapter2_step11im.PNG)

> 注:この設定は、投げることができるボールの作成などのシナリオに適しています。 ベロシティと角速度を維持することにより、ボールがリリースされた後も、物理的なボールの動作と同様に、そのボールがリリースされた速度で移動し続けます。

### <a name="adding-bounding-boxes"></a>境界ボックスの追加
境界ボックスにより、直接操作 (近距離操作) と 光線による操作 (遠距離操作) の両方で、オブジェクトを片手でより簡単で直感的に操作できるようになります。境界ボックスは、特定の軸に沿ってオブジェクトを拡大縮小および回転するために取得できるハンドルを提供します。
>注:オブジェクトに境界ボックスを追加する前に、まず、このレッスンで行ったように、オブジェクト (box collider など) に collider を用意する必要があります。 コライダーを追加するには、オブジェクトを選択し、オブジェクトの [インスペクター] パネルで [コンポーネントの追加] > [ボックス コライダー] を選択します。
>

1. 箱の collider を地球コアオブジェクトに追加します (まだ存在しない場合)。 指定された指示に従って、ベースモジュールアセットフォルダーに用意されている prefab を使用する場合、box collider とセットアップは必要ありません。 地球コアの場合は、次の図に示すように、箱を node_id30、地球コアの下にあるオブジェクトに追加しました。 オブジェクトの [インスペクター] タブで [node_id30] を選択し、[コンポーネントの追加] をクリックして、box collider を検索します。 

![Lesson4 Chapter3 Step1im](images/Lesson4_Chapter3_step1im.PNG)

![Lesson4 Chapter3 Step2im](images/Lesson4_chapter3_step2im.PNG)

> 注:Box collider のサイズを大きくしたり小さくしたりしないようにしてください。 それが囲むオブジェクト (この例では地球の核) とほぼ同じサイズである必要があります。 Box collider の [Collider の編集] オプションを選択して、必要に応じて box の collider を調整します。 X、y、z の値を変更するか、[エディターシーン] ウィンドウで境界ボックスハンドラーをドラッグします。 

![Lesson4 Chapter3 Noteim](images/Lesson4_Chapter3_noteim.PNG)

2. 地球コアの node_id30 オブジェクトに境界ボックスを追加します。 これを行うには、3DObjectCollection から node_id30 オブジェクトを選択します。 [インスペクター] タブで、[コンポーネントの追加] をクリックし、[境界ボックス] を検索します。 境界ボックス、ボックス コライダー、および操作スクリプト (操作ハンドラー、近距離操作 - グラブ可能) がすべて同じゲーム オブジェクト上にあることを確認します。

3.  境界ボックスの [動作] セクションで、[アクティブ化] ドロップダウンリストから [開始時にアクティブにする] を選択します。 さまざまなアクティブ化のオプションとその他の境界ボックスのオプションの詳細については、[MRTK の境界ボックスのドキュメント](<https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/README_BoundingBox.html>)を参照してください

   

   *次のいくつかの手順では、既定のボックスマテリアル、グラブ中の素材、コーナーハンドルとサイドハンドルの視覚化を調整して、境界ボックスがどのように見えるかを変更します。MRTK には、境界ボックスをカスタマイズするためのいくつかのオプションが含まれています。*

4. [プロジェクト] パネルで boundingbox を検索すると、次の図に示すように、検索結果に青い球で示される素材の一覧が表示されます。 

5. Boundingbox マテリアルを、境界ボックスコンポーネントのボックス素材スロットにドラッグします。 また、boundingboxgrabbed の素材を取得し、境界ボックスコンポーネントのボックスにある素材スロットに配置します。

6. MRTK_BoundingBox_ScaleWidget prefab を、境界ボックスコンポーネントのスケールハンドル prefab スロットにドラッグします。 

7. MRTK_BoundingBox_RotateWidget prefab を結合ボックスコンポーネントの回転ハンドルスロットにドラッグします。

![Lesson4 Chapter3 Step4 7Im](images/Lesson4_chapter3_step4-7im.PNG)

8. 境界ボックスの正しいオブジェクトを対象としていることを確認します。 境界ボックスコンポーネントには、ターゲットオブジェクトと境界オーバーライドスクリプトがあります。 必ず、これらのスロットの両方に、周囲に境界ボックスがあるオブジェクトをドラッグしてください。 この例では、次の図に示すように、これらのスロットの両方に node_id30 オブジェクトをドラッグします。

> アプリケーションを起動または再生すると、オブジェクトは青いフレームで囲まれます。 そのフレームのコーナーをドラッグすると、オブジェクトのサイズを自由に変更できます。 スケーリングハンドルと回転ハンドルのサイズを大きくして表示する場合は、既定の境界ボックスの設定を使用することをお勧めします (手順 4. ~ 7. を回避)。 

![Lesson4 Chapter3 Step8im](images/Lesson4_Chapter3_step8im.PNG)

9. 既定の境界ボックスの視覚化に戻るには、境界ボックスのオブジェクトの [インスペクター] パネルで、回転ハンドル prefab を選択し、Del キーを押します。 次の画像のような境界ボックスの視覚エフェクトが表示されます。 注: 境界ボックスの視覚エフェクトは、再生モードの場合にのみ表示されます。

![Lesson4 Chapter3 Step9im](images/Lesson4_chapter3_step9im.PNG)

### <a name="adding-touch-effects"></a>タッチ効果の追加
この例では、オブジェクトを手でタッチしたときに効果音が再生されるようにします。

1. ゲーム オブジェクトにオーディオ ソース コンポーネントを追加します。 シーン階層で Octa オブジェクトを選択します。 [インスペクター] パネルで [コンポーネントの追加] ボタンをクリックし、[オーディオソース] を検索して選択します。 後の方の手順で、このオーディオ ソースを使用して効果音を再生します。 

>注:Octa オブジェクトに box collider があることを確認します。

2. Near 対話 Touchable コンポーネントを追加します。 [インスペクター] パネルの [コンポーネントの追加] ボタンをクリックし、[near インタラクション touchable] を検索します。 選択してコンポーネントに追加します。 

>注:以前は、grabbable の近くに追加しました。 この相互作用 touchable の違いは、grabbable の相互作用は、オブジェクトをグラブして操作することを意図しています。 Touchable コンポーネントは、タッチするオブジェクトを対象としています。 操作を組み合わせるために両方のコンポーネントを一緒に使用することができます。

![Lesson4 Chapter4 Step1 2Im](images/Lesson4_chapter4_step1-2im.PNG)

3. ハンドインタラクションタッチスクリプトにを追加します。 このスクリプトは、このデモの一部としてインポートした Unity シーンに含まれており、元の MRTK には含まれていないことに注意してください。 前の手順と同じように、[コンポーネントの追加] をクリックして、ハンド相互作用タッチを検索して追加します。

>スクリプトには次の3つのオプションがあることに注意してください。 

>   - タッチ完了時:オブジェクトをタッチして解放するとトリガーされます
>   - タッチ開始時:オブジェクトがタッチされたときにトリガーします
>   - タッチ更新時:手がオブジェクトに接している間、定期的にトリガーします

>   この例では、[タッチによる開始] 設定を使用します。

4. 次の図に示すように、[タッチ開始時] オプションの [+] ボタンをクリックします。 Octa オブジェクトを空のフィールドにドラッグします。 

5. [関数がありません] と表示されているドロップダウン (下図の図の緑色の四角形の上) で、[AudioSource-> PlayOneShot] を選択します。 以下のコンセプトを元に、このフィールドにオーディオ クリップを追加します。

   - MRTK には、オーディオ クリップの小さいリストがあります。 これらは [プロジェクト] パネルで探すことができます。 これらのファイルは、MixedRealityToolkit フォルダーと、Standard Assets フォルダーの下にあります。 ここには、すべてのオーディオクリップがあるオーディオフォルダーが表示されます。
   - この例では、MRTK_Gem オーディオクリップを使用します。 
   - オーディオ クリップを追加するには、目的のクリップを [プロジェクト] パネルから [インスペクター] パネルの [AudioSource.PlayOneShot] (上記の例で緑色のボックスでマークされています) にドラッグするだけです。

   これで、ユーザーがに到達し、Octa オブジェクトに触れると、オーディオトラック MRTK_Gem が再生されます。 また、ハンドインタラクションタッチスクリプトによって、オブジェクトの色も調整されます。 

![Lesson4 Chapter4 Step3 5 Noteim](images/Lesson4_chapter4_step3-5-noteim.PNG)

### <a name="congratulations"></a>結論 
このチュートリアルでは、グリッドコレクション内の3D オブジェクトを整理する方法と、近くの操作 (追跡したハンドを使用した直接グラブ) と遠くの相互作用 (宝石を使用した、または光線を使用) を使用して、3D オブジェクトを操作する方法について学習しました。 また、3D オブジェクトの周囲に境界ボックスを配置する方法と、境界ボックスでギズモを使用およびカスタマイズする方法についても学習しました。 最後に、オブジェクトにタッチしたときにイベントをトリガーする方法を学習しました。

[次のレッスン: 高度な入力](mrlearning-base-ch5.md)

