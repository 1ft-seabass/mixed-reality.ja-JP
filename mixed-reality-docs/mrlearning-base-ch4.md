---
title: MR 学習ベース モジュール - 3D オブジェクトの操作
description: このコースを完了すると、Mixed Reality アプリケーション内で Azure 顔認識を実装する方法を学習することができます。
author: jessemcculloch
ms.author: jemccull
ms.date: 02/26/2019
ms.topic: article
ms.localizationpriority: high
keywords: Mixed Reality、Unity、チュートリアル、Hololens
ms.openlocfilehash: 45e772de0825fe2161f880a165d6c75c755b849e
ms.sourcegitcommit: f20beea6a539d04e1d1fc98116f7601137eebebe
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/05/2019
ms.locfileid: "65730905"
---
# <a name="mr-learning-base-module---3d-object-interaction"></a>MR 学習ベース モジュール - 3D オブジェクトの操作

このレッスンでは、基本的な 3D コンテンツとユーザー エクスペリエンスについて説明します。 コレクションの一部としての 3D オブジェクトの整理、基本的な操作のための境界ボックス、近距離操作と遠距離操作、および手の追跡によるタッチ ジェスチャとグラブ ジェスチャについて説明します。 

## <a name="objectives"></a>目標

* MRTK の Grid Object Collection を使用して 3D コンテンツを整理する方法を学習する
* 境界ボックスを実装する
* 基本的な操作 (移動、回転、および拡大縮小) のために 3D オブジェクトを構成する
* 近距離操作と遠距離操作について確認する
* グラブやタッチなどのその他の手の追跡のジェスチャについて学習する

## <a name="instructions"></a>手順

### <a name="organizing-3d-objects-in-a-collection"></a>3D オブジェクトをコレクションに整理する

1. 階層を右クリックし、[空の作成] を選択します。 これにより、空のゲーム オブジェクトが作成されます。 その名前を [3DObjectCollection] に変更します。 ここに、すべての 3 D オブジェクトを保存します。 コレクションの位置が x = 0、y = 0、z = 0 に設定されていることを確認します。

![Lesson4 Chapter1 Step1im](images/Lesson4_Chapter1_step1im.PNG)

2. 同じ手順を使用して BaseModule アセットをインポートして、[レッスン 1](mrlearning-base-ch1.md) で説明したカスタム パッケージをインポートします。 BaseModule アセットには、このチュートリアル全体を通して使用する 3D モジュールとその他の便利なスクリプトが含まれています。 BaseModule Unity パッケージは <https://github.com/Microsoft/MixedRealityLearning/releases/tag/V1.1> で入手できます

3. コーヒー カップのプレハブは、その横にある青色の立方体で見分けることができます。 青色の立方体と小さい白い紙が付いたコーヒー カップは選択しないでください (プレハブではなく、元の 3D モデルを示しています。) 

![Lesson4 Chapter1 Noteaim](images/Lesson4_chapter1_noteaim.PNG)

4. 選択したコーヒー カップのプレハブを、手順 1 の [3DObjectCollection] ゲーム オブジェクト内にドラッグします。 これでコーヒー カップはコレクションの子になりました。

![Lesson4 Chapter1 Step4ima](images/Lesson4_chapter1_step4ima.PNG)

5. 次に、シーンに 3 D オブジェクトを追加します。 この例で追加するオブジェクトの一覧を以下に示します。 オブジェクトを追加すると、オブジェクトがさまざまなサイズでシーンに表示されることがあります。 各 3D モデルのスケールは [インスペクター] パネルの変換設定で調整します。 この例で推奨される調整とそのオブジェクトを以下に示します。 [プロジェクト] パネルの検索ボックスで以下の単語を検索し、前の手順と同様に 3D オブジェクトのプレハブを [3DObjectCollection] オブジェクトにドラッグします。 これらのプレハブのコレクションは [アセット] > [BaseModuleAssets] > [ベース モジュール プレハブ] にあります
- [TheModule_BaseModuleIncomplete] を検索します。 シーン内にドラッグします。 スケールを x = 0.03、y = 0.03、z = 0.03 に設定します。 
- [Octa_BaseModuleIncomplete] を検索します。 シーン内にドラッグします。 スケールを x = 0.13、 y = 0.13、z =0.13 に設定します。
- [EarthCore_BaseModuleIncomplete] を検索します。 シーン内にドラッグします。 スケールを x = 50.0、y = 50.0、z = 50.0 に設定します。
- [Cheese_BaseModuleIncomplete] を検索します。 シーン内にドラッグします。 スケールを x = 0.05、y = 0.05、z = 0.05 に設定します。
- [Model_Platonic_BaseModuleIncomplete] を検索します。 シーン内にドラッグします。 スケールを x = 0.13、y = 0.13、z = 0.13 に設定します。
- [CoffeeCup_BaseModuleIncomplete] を検索します。 シーン内にドラッグします。

![Lesson4 Chapter1 Step5im](images/Lesson4_Chapter1_step5im.PNG)

6. 3 つの立方体をシーンに追加します。 [3DObjectCollection] オブジェクトを右クリックして [3D オブジェクト] を選択し、[立方体] をクリックします。 スケールを x = 0.14、y = 0.14、z = 0.14 に設定します。 この手順をさらに 2 回繰り返して、合計 3 つの立方体を作成します。 または、合計 3 つになるよう立方体を 2 回複製します。 また、[アセット] > [BaseModuleAssets] > [ベース モジュール プレハブ] から用意されている 3 つの立方体のプレハブを使用し、GreenCube_BaseModuleIncomplete、BlueCube_BaseModuleIncomplete、および OrangeCube_BaseModuleIncomplete を選択することもできます。

![Lesson4 Chapter1 Step6im](images/Lesson4_Chapter1_step6im.PNG)

7. MRTK の Grid Object Collection を使用して、[レッスン 2](mrlearning-base-ch2.md) で説明した手順で、オブジェクトのコレクションを整理してグリッドを形成します。 3x3 グリッドでのオブジェクトの構成例については、次の図を参照してください。

![Lesson4 Chapter1 Notebim](images/Lesson4_chapter1_notebim.PNG)

>注:上の図のオブジェクトのように、一部のオブジェクトが中心から外れている場合があります。 これは、プレハブまたはオブジェクトに整列していない子オブジェクトが含まれている可能性があるためです。 オブジェクトの位置や子オブジェクトの位置に必要な調整を自由に加えることで、グリッドを適切に整列させることができます。


### <a name="manipulating-3d-objects"></a>3D オブジェクトの操作
1. 立方体を操作する機能を追加します。 3D オブジェクトを操作する機能を追加するには、次の操作を行う必要があります。
-   階層で操作する 3D オブジェクトを選択します (この例では立方体の 3D オブジェクト)。
-   [コンポーネントの追加] をクリックします。 
-   [操作] を検索します。
-   [操作ハンドラー] を選択します。
-   [3DObjectCollection] オブジェクトそのものではなく、[3DObjectCollection] の下にあるすべての 3D オブジェクトに対して繰り返します。
-   すべての 3D オブジェクトにコライダーまたはボックス コライダーがあることを確認します ([コンポーネントの追加] > [ボックス コライダー])。

![Lesson4 Chapter2 Step1im](images/Lesson4_chapter2_step1im.PNG)

>操作ハンドラーは、操作中のオブジェクトの動作の設定を調整できるようにするコンポーネントです。 これには、特定の軸上での回転、拡大縮小、移動、および動きの制限が含まれます。 

2. 1 つの立方体を、拡大縮小しかできないように制限します。 [3DObjectCollection] オブジェクトの 1 つの立方体を選択します。 [インスペクター] パネルで、[両手を使った操作の種類] の横にあるドロップダウン メニューをクリックし、[拡大縮小] を選択します。 これにより、ユーザーは立方体のサイズしか変更できなくなります。

![Lesson4 Chapter2 Step2im](images/Lesson4_Chapter2_step2im.PNG)

3. 立方体を区別できるように、それぞれの色を変更します。 
-   [プロジェクト] パネルに移動し、下にスクロールして、[MixedRealityToolkit.SDK] が表示されたら選択します。
-   [標準アセット] フォルダーを選択します。
-   [素材] フォルダーをクリックします。
-   立方体のそれぞれに異なる素材をドラッグします。 

>注:立方体には任意の色を選択できます。 この例では、[glowingcyan]、[glowingorange]、および [green] を使用します。 さまざまな色を自由に試すことができます。 立方体に色を追加するには、色を変更したい立方体をクリックして、立方体の [インスペクター] パネルのメッシュ レンダラーの素材フィールドに素材をドラッグします。 

![Lesson4 Chapter2 Step3im](images/Lesson4_Chapter2_step3im.PNG)

4. [3DObjectCollection] オブジェクトの別の立方体を選択して、その動きが頭部から一定の距離に制限されるようにします。 これを行うには、[動きの制限] の右側にあるドロップダウン メニューをクリックし、[頭部から一定の距離] を選択します。 これにより、ユーザーは視野内でしか立方体を動かせなくなります。 

![Lesson4 Chapter2 Step4im](images/Lesson4_chapter2_step4im.PNG)

次のいくつかの手順の目標:3D オブジェクトに対してグラブと操作ができるようにします。 さまざまな操作の設定を適用します。 

5. チーズのオブジェクトを選択し、[インスペクター] パネルで、[コンポーネントの追加] をクリックします。 

6. 検索ボックスで [近距離操作 - グラブ可能] を検索し、スクリプトを選択します。 このコンポーネントにより、ユーザーは、追跡対象の手で触れてグラブすることができます。 また、[遠距離操作を許可] チェック ボックスをオフにしない限り (下の図の緑色の円で示されています)、オブジェクトを離れた位置から操作することもできます。

![Lesson4 Chapter2 Step6im](images/Lesson4_Chapter2_step6im.PNG)

7. Octa オブジェクト、Platonic オブジェクト、地球の核、月着陸船、およびコーヒー カップの各オブジェクトに対して手順 5 と 6 を繰り返して、これらのオブジェクトに [近距離操作 - グラブ可能] を追加します。

8. Octa オブジェクトから遠距離操作ができないようにします。 これを行うには、階層で [Octa] を選択し、[遠距離操作を許可] チェック ボックスをオフにします (緑色の円でマークが付けられています)。 これにより、ユーザーは、Octa を追跡対象の手で直接操作することしかできなくなります。

>注:操作ハンドラーのコンポーネントとそれに関連する設定の詳細なドキュメントについては、[MRTK のドキュメント](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/README_ManipulationHandler.html)を参照してください。

9. 地球の核、月着陸船、およびコーヒー カップに [近距離操作 - グラブ可能] コンポーネントが追加されていることを確認します (手順 7 を参照)。

10. 月着陸船の場合は、次の図に示すように、近距離操作と遠距離操作の両方でオブジェクトを中心に回転するように、操作ハンドラーの設定を変更します。

![Lesson4 Chapter2 Step10im](images/Lesson4_chapter2_step10im.PNG)

11:地球の核の場合は、離したときの動作を [なし] に変更します。 これにより、ユーザーがつかんでいた地球の核が、離した後で移動を続けなくなります。 

![Lesson4 Chapter2 Step11im](images/Lesson4_Chapter2_step11im.PNG)

> 注:この設定は、投げることができるボールの作成などのシナリオに適しています。 速度と角速度を維持することで、物理的なボールの動きと同様に、離したボールが離したときの速度で動き続けます。

### <a name="adding-bounding-boxes"></a>境界ボックスの追加
境界ボックスにより、直接操作 (近距離操作) と 光線による操作 (遠距離操作) の両方で、オブジェクトを片手でより簡単で直感的に操作できるようになります。境界ボックスには、グラブすることでオブジェクトを特定の軸に沿って拡大縮小したり回転させたりできる "ハンドル" があります。
>注:オブジェクトに境界ボックスを追加するには、オブジェクト上にコライダー (ボックス コライダーなど) がなければなりません。これについてはこのレッスンの前の方で説明しました。 コライダーを追加するには、オブジェクトを選択し、オブジェクトの [インスペクター] パネルで [コンポーネントの追加] > [ボックス コライダー] を選択します。
>

1. まだ存在していない場合は、地球の核オブジェクトにボックス コライダーを追加します (BaseModule アセット フォルダーにあるプレハブを、記載されている手順に従って使用する場合、ボックス コライダーとセットアップは必要ありません。)地球の核の場合は、次の図に示すように、地球の核の下にある [node_id30] オブジェクトにボックス コライダーを追加する必要があります。 オブジェクトの [インスペクター] タブで [node_id30] を選択し、[コンポーネントの追加] をクリックし、[ボックス コライダー] を検索します。 

![Lesson4 Chapter3 Step1im](images/Lesson4_Chapter3_step1im.PNG)

![Lesson4 Chapter3 Step2im](images/Lesson4_chapter3_step2im.PNG)

> 注:ボックス コライダーは大きすぎたり小さすぎたりしないように視覚化してください。 それが囲むオブジェクト (この例では地球の核) とほぼ同じサイズである必要があります。 必要に応じて、ボックス コライダーで [コライダーの編集] オプションを選択してボックス コライダー を調整します。 x、y、および z の値を変更するか、エディターのシーン ウィンドウで境界ボックスのハンドラーをドラッグすることができます。 

![Lesson4 Chapter3 Noteim](images/Lesson4_Chapter3_noteim.PNG)

2. 地球の核の [node_id30] オブジェクトに境界ボックスを追加します。 これを行うには、[3DObjectCollection] から [node_id30] オブジェクトを選択します。 [インスペクター] タブで [コンポーネントの追加] をクリックし、[境界ボックス] を検索します。 境界ボックス、ボックス コライダー、および操作スクリプト (操作ハンドラー、近距離操作 - グラブ可能) がすべて同じゲーム オブジェクト上にあることを確認します。

3.  境界ボックスの [動作] セクションで、[アクティブ化] ドロップダウン リストから [開始時にアクティブ化] を選択します。 さまざまなアクティブ化のオプションとその他の境界ボックスのオプションの詳細については、[MRTK の境界ボックスのドキュメント](<https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/README_BoundingBox.html>)を参照してください

   

   *次のいくつかの手順では、既定のボックス素材、グラブ中の素材、およびハンドルの視覚エフェクト (コーナーと左右のハンドル) を調整することで、境界ボックスの外観も変更します。MRTK には、境界ボックスをカスタマイズするためのいくつかのオプションが含まれています。*

4. [プロジェクト] パネルで [boundingbox] を検索すると、次の図に示すように、検索結果に青い球体で表される素材のリストが表示されます。 

5. [boundingbox] 素材を、[境界ボックス] コンポーネントの [ボックス素材] スロットにドラッグします。 また、[Boundingboxgrabbed] 素材も、グラブして、[境界ボックス] コンポーネントの [ボックスでグラブした素材] スロットに入れます。

6. [MRTK_BoundingBox_ScaleWidget] 素材を [境界ボックス] コンポーネントの [拡大縮小ハンドル プレハブ] スロットにドラッグします。 

7. [MRTK_BoundingBox_RotateWidget] 素材を [境界ボックス] コンポーネントの [回転ハンドル] スロットにドラッグします。

![Lesson4 Chapter3 Step4 7Im](images/Lesson4_chapter3_step4-7im.PNG)

8. 境界ボックスの正しいオブジェクトを対象としていることを確認します。 [境界ボックス] コンポーネントには、[ターゲット オブジェクト] スクリプトと [境界オーバーライド] スクリプトがあります。 必ず、これらのスロットの両方に、周囲に境界ボックスがあるオブジェクトをドラッグしてください。 この例では、次の図に示すように、[node_id30] オブジェクトをこれら両方のスロットにドラッグします。

> アプリケーションを起動または再生すると、オブジェクトが青い枠で囲まれます。 そのフレームのコーナーをドラッグすると、オブジェクトのサイズを自由に変更できます。 拡大縮小ハンドルと回転ハンドルを大きくして見やすくしたい場合は、既定の境界ボックスの設定 (手順 4 ～ 7 を除く) を使用することをお勧めします。 

![Lesson4 Chapter3 Step8im](images/Lesson4_Chapter3_step8im.PNG)

9. 既定の境界ボックスの視覚エフェクトに戻すには、境界ボックスのオブジェクトの [インスペクター] パネルで回転ハンドルのプレハブを選択して Delete キーを押すと、次の図のような境界ボックスの視覚エフェクトが表示されます。 注: 境界ボックスの視覚エフェクトは、再生モードの場合にのみ表示されます。

![Lesson4 Chapter3 Step9im](images/Lesson4_chapter3_step9im.PNG)

### <a name="adding-touch-effects"></a>タッチ エフェクトの追加
この例では、オブジェクトを手でタッチしたときに効果音が再生されるようにします。

1. ゲーム オブジェクトにオーディオ ソース コンポーネントを追加します。 シーン階層で [octa] オブジェクトを選択します。 [インスペクター] パネルで、[コンポーネントの追加] ボタンをクリックして、[オーディオ ソース] を検索して選択します。 後の方の手順で、このオーディオ ソースを使用して効果音を再生します。 

>注:[Octa] オブジェクトにボックス コライダーがあることを確認してください。

2. [近距離操作 - タッチ可能] コンポーネントを追加します。 [インスペクター] パネルで、[コンポーネントの追加] ボタンをクリックして、[近距離操作 - タッチ可能] を検索します。 選択してコンポーネントに追加します。 注: スクリーンショットを修正して、ボックス コライダーを強調するだけでなく、コンポーネントを追加していることを強調してください。

>注:[近距離操作 - グラブ可能] は既に追加しています。 これと [近距離操作 - タッチ可能] の違いは、[グラブ可能] な操作はグラブして操作するオブジェクトを対象としていることです。 [タッチ可能] コンポーネントは、タッチするオブジェクトを対象としています。 操作を組み合わせるために両方のコンポーネントを一緒に使用することができます。

![Lesson4 Chapter4 Step1 2Im](images/Lesson4_chapter4_step1-2im.PNG)

3. [手による操作、タッチ] スクリプトを追加します。 このスクリプトは、このデモ パッケージの一部としてインポートした Unity シーンに含まれていて、オリジナルの MRTK には含まれていないことに注意してください。 前の手順と同様に、[コンポーネントの追加] をクリックし、[手による操作、タッチ] を検索して追加します。 
   このスクリプトでは 3 つのオプションがあることに注意してください。 

   - [タッチ完了時]。 これは、オブジェクトをタッチしてから離したときにトリガーされます。 
   - [タッチ開始時]。 これは、オブジェクトがタッチされたときにトリガーされます。 
   - [タッチ更新時]。 これは、手がオブジェクトにタッチしているときに定期的にトリガーされます。 

   この例では、[タッチ開始時] の設定を使用します。

4. 次の図に示すように、[タッチ開始時] オプションの [+] ボタンをクリックします。 Octa オブジェクトを空のフィールドにドラッグします。 

5. [関数なし] を示すドロップダウン リスト (下の画像の緑の四角形) で、[AudioSource] > [PlayOneShot] の順に選択します。 以下のコンセプトを元に、このフィールドにオーディオ クリップを追加します。

   - MRTK には、オーディオ クリップの小さいリストがあります。 これらは [プロジェクト] パネルで探すことができます。 これは、[MixedRealityToolkit.SDK] フォルダーの [標準アセット] フォルダーの下にあります。 ここでは、すべてのオーディオ クリップが含まれている [オーディオ] フォルダーが表示されます。
   - この例では、[MRTK_Gem] オーディオ クリップを使用します。 
   - オーディオ クリップを追加するには、目的のクリップを [プロジェクト] パネルから [インスペクター] パネルの [AudioSource.PlayOneShot] (上記の例で緑色のボックスでマークされています) にドラッグするだけです。

   これでユーザーが Octa オブジェクトに触れてタッチできるようになると、オーディオ トラック [MRTK_Gem] が再生されます。 [手による操作、タッチ] スクリプトは、タッチしたときのオブジェクトの色も調整します。 

![Lesson4 Chapter4 Step3 5 Noteim](images/Lesson4_chapter4_step3-5-noteim.PNG)

### <a name="congratulations"></a>結論 
このレッスンでは、3D オブジェクトをグリッド コレクションに整理する方法と、近距離操作 (追跡対象の手で直接グラブ) と遠距離操作 (視線入力または手の光線を使用) を使用して 3D オブジェクトを操作 (拡大縮小、回転、および移動) する方法を学習しました。また、3D オブジェクトの周りに境界ボックスを配置する方法と、境界ボックスのギズモの使用とカスタマイズの方法についても学習しました。 最後に、オブジェクトにタッチしたときにイベントをトリガーする方法を学習しました。

[次のレッスン: 高度な入力](mrlearning-base-ch5.md)

