---
title: 空間マッピングのデザイン
description: HoloLens 内で空間マッピングを効果的に使用するには、多くの要因を慎重に検討する必要があります。
author: cre8ivepark
ms.author: dongpark
ms.date: 03/21/2018
ms.topic: article
keywords: Windows Mixed Reality、設計、空間マッピング、HoloLens、surface 再構築、メッシュ
ms.openlocfilehash: 02e64727f9a23bea28e018d7c4e5a8b89c152447
ms.sourcegitcommit: 60f73ca23023c17c1da833c83d2a02f4dcc4d17b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/17/2019
ms.locfileid: "69566011"
---
# <a name="spatial-mapping-design"></a><span data-ttu-id="83d79-104">空間マッピングのデザイン</span><span class="sxs-lookup"><span data-stu-id="83d79-104">Spatial mapping design</span></span>

<span data-ttu-id="83d79-105">HoloLens 内で空間マッピングを効果的に使用するには、多くの要因を慎重に検討する必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-105">Effective use of spatial mapping within HoloLens requires careful consideration of many factors.</span></span>

## <a name="device-support"></a><span data-ttu-id="83d79-106">デバイスのサポート</span><span class="sxs-lookup"><span data-stu-id="83d79-106">Device support</span></span>

<table>
    <colgroup>
    <col width="33%" />
    <col width="33%" />
    <col width="33%" />
    </colgroup>
    <tr>
        <td><span data-ttu-id="83d79-107"><strong>機能</strong></span><span class="sxs-lookup"><span data-stu-id="83d79-107"><strong>Feature</strong></span></span></td>
        <td><span data-ttu-id="83d79-108"><a href="hololens-hardware-details.md"><strong>HoloLens</strong></a></span><span class="sxs-lookup"><span data-stu-id="83d79-108"><a href="hololens-hardware-details.md"><strong>HoloLens</strong></a></span></span></td>
        <td><span data-ttu-id="83d79-109"><a href="immersive-headset-hardware-details.md"><strong>イマーシブ ヘッドセット</strong></a></span><span class="sxs-lookup"><span data-stu-id="83d79-109"><a href="immersive-headset-hardware-details.md"><strong>Immersive headsets</strong></a></span></span></td>
    </tr>
     <tr>
        <td><span data-ttu-id="83d79-110">空間マッピングのデザイン</span><span class="sxs-lookup"><span data-stu-id="83d79-110">Spatial mapping design</span></span></td>
        <td><span data-ttu-id="83d79-111">✔️</span><span class="sxs-lookup"><span data-stu-id="83d79-111">✔️</span></span></td>
        <td><span data-ttu-id="83d79-112">❌</span><span class="sxs-lookup"><span data-stu-id="83d79-112">❌</span></span></td>
    </tr>
</table>

## <a name="why-is-spatial-mapping-important"></a><span data-ttu-id="83d79-113">空間マッピングが重要な理由</span><span class="sxs-lookup"><span data-stu-id="83d79-113">Why is spatial mapping important?</span></span>

<span data-ttu-id="83d79-114">空間マッピングを使用すると、オブジェクトを実際のサーフェイスに配置できます。</span><span class="sxs-lookup"><span data-stu-id="83d79-114">Spatial mapping makes it possible to place objects on real surfaces.</span></span> <span data-ttu-id="83d79-115">これは、オブジェクトをユーザーの世界に固定し、実際の深さの手掛かりを活用するのに役立ちます。他のホログラムや実際のオブジェクトに基づいてホログラムを Occluding することで、これらのホログラムが実際に空間にあることをユーザーに納得させることができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-115">This helps anchor objects in the user's world and takes advantage of real world depth cues. Occluding your holograms based on other holograms and real world objects helps convince the user that these holograms are actually in their space.</span></span> <span data-ttu-id="83d79-116">領域内のホログラムまたはユーザーとの移動は実際とは言えません。</span><span class="sxs-lookup"><span data-stu-id="83d79-116">Holograms floating in space or moving with the user will not feel as real.</span></span> <span data-ttu-id="83d79-117">可能な場合は、アイテムを快適に配置します。</span><span class="sxs-lookup"><span data-stu-id="83d79-117">When possible, place items for comfort.</span></span>

<span data-ttu-id="83d79-118">ホログラムを配置または移動するときにサーフェイスを視覚化します (単純な射影グリッドを使用します)。</span><span class="sxs-lookup"><span data-stu-id="83d79-118">Visualize surfaces when placing or moving holograms (use a simple projected grid).</span></span> <span data-ttu-id="83d79-119">これにより、ユーザーがホログラムを最適に配置できる場所を知ることができます。また、ホログラムを配置しようとしている場所がまだマップされていない場合は、ユーザーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="83d79-119">This will help the user know where they can best place their holograms, and shows the user if the spot they are trying to place the hologram hasn't been mapped yet.</span></span> <span data-ttu-id="83d79-120">角度が非常に多い場合は、ユーザーに "ビルボード項目" を設定できます。</span><span class="sxs-lookup"><span data-stu-id="83d79-120">You can "billboard items" toward the user if they end up at too much of an angle.</span></span>

## <a name="what-influences-spatial-mapping-quality"></a><span data-ttu-id="83d79-121">空間マッピングの品質に影響を与えるもの</span><span class="sxs-lookup"><span data-stu-id="83d79-121">What influences spatial mapping quality?</span></span>

<span data-ttu-id="83d79-122">[ここ](environment-considerations-for-hololens.md)で説明するいくつかの要素は、これらのエラーの頻度と重大度に影響を与える可能性があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-122">Several factors, detailed [here](environment-considerations-for-hololens.md), can affect the frequency and severity of these errors.</span></span>  <span data-ttu-id="83d79-123">ただし、空間マッピングデータにエラーがある場合でも、ユーザーが目標を達成できるように、アプリケーションを設計する必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-123">However, you should design your application so that the user is able to achieve their goals even in the presence of errors in the spatial mapping data.</span></span>

## <a name="the-environment-scanning-experience"></a><span data-ttu-id="83d79-124">環境のスキャンエクスペリエンス</span><span class="sxs-lookup"><span data-stu-id="83d79-124">The environment scanning experience</span></span>

<span data-ttu-id="83d79-125">空間マッピングを使用する各アプリケーションでは、"スキャンエクスペリエンス" を提供することを検討する必要があります。アプリケーションが正常に機能するために必要なサーフェイスをスキャンするためにアプリケーションがユーザーに指示するプロセス。</span><span class="sxs-lookup"><span data-stu-id="83d79-125">Each application that uses spatial mapping should consider providing a 'scanning experience'; the process through which the application guides the user to scan surfaces that are necessary for the application to function correctly.</span></span>

<span data-ttu-id="83d79-126">![スキャンの例](images/sr-mixedworld-140429-8pm-00068-1000px.png)</span><span class="sxs-lookup"><span data-stu-id="83d79-126">![Example of scanning](images/sr-mixedworld-140429-8pm-00068-1000px.png)</span></span><br>
<span data-ttu-id="83d79-127">*スキャンの例*</span><span class="sxs-lookup"><span data-stu-id="83d79-127">*Example of scanning*</span></span>

<span data-ttu-id="83d79-128">このスキャンエクスペリエンスの性質は、アプリケーションのニーズによって大きく異なる場合がありますが、主に2つの原則として設計を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-128">The nature of this scanning experience can vary greatly depending upon each application's needs, but two main principles should guide its design.</span></span>

<span data-ttu-id="83d79-129">まず、**ユーザーとの通信をクリア**します。</span><span class="sxs-lookup"><span data-stu-id="83d79-129">Firstly, **clear communication with the user is the primary concern**.</span></span> <span data-ttu-id="83d79-130">ユーザーは、アプリケーションの要件が満たされているかどうかを常に把握している必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-130">The user should always be aware of whether the application's requirements are being met.</span></span> <span data-ttu-id="83d79-131">これらが満たされていない場合は、その理由をユーザーにすぐに明確にする必要があります。また、適切な操作を行うための迅速な対応が必要になります。</span><span class="sxs-lookup"><span data-stu-id="83d79-131">When they are not being met, it should be immediately clear to the user why this is so and they should be quickly led to take the appropriate action.</span></span>

<span data-ttu-id="83d79-132">また、**アプリケーションは、効率性と信頼性のバランスを取るように試み**ます。</span><span class="sxs-lookup"><span data-stu-id="83d79-132">Secondly, **applications should attempt to strike a balance between efficiency and reliability**.</span></span> <span data-ttu-id="83d79-133">**信頼性**を高めるために、アプリケーションでは、ユーザー時間を節約するために、空間マッピングデータを自動的に分析する必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-133">When it is possible to do so **reliably**, applications should automatically analyze spatial mapping data to save the user time.</span></span> <span data-ttu-id="83d79-134">信頼性を高めることができない場合は、アプリケーションでは、アプリケーションに必要な追加情報を迅速に提供できるようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-134">When it is not possible to do so reliably, applications should instead enable the user to quickly provide the application with the additional information it requires.</span></span>

<span data-ttu-id="83d79-135">適切なスキャンエクスペリエンスを設計するために、アプリケーションに適用できる次のような可能性を検討してください。</span><span class="sxs-lookup"><span data-stu-id="83d79-135">To help design the right scanning experience, consider which of the following possibilities are applicable to your application:</span></span>

* <span data-ttu-id="83d79-136">**スキャンエクスペリエンスがありません**</span><span class="sxs-lookup"><span data-stu-id="83d79-136">**No scanning experience**</span></span>
   * <span data-ttu-id="83d79-137">アプリケーションは、ガイド付きスキャンを使用しなくても完璧に機能します。自然なユーザー移動の過程で観察されたサーフェイスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="83d79-137">An application may function perfectly without any guided scanning experience; it will learn about surfaces that are observed in the course of natural user movement.</span></span>
   * <span data-ttu-id="83d79-138">たとえば、ユーザーが holographic スプレーペイントを使用してサーフェイス上に描画できるようにするアプリケーションでは、ユーザーに現在表示されているサーフェイスの知識のみが必要です。</span><span class="sxs-lookup"><span data-stu-id="83d79-138">For example an application that lets the user draw on surfaces with holographic spray paint requires knowledge only of the surfaces currently visible to the user.</span></span>
   * <span data-ttu-id="83d79-139">ユーザーが HoloLens を使用して既に多数の時間を費やしている場合、環境は既に完全にスキャンされている可能性があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-139">The environment may be completely scanned already if it is one in which the user has already spent a lot of time using the HoloLens.</span></span>
   * <span data-ttu-id="83d79-140">ただし、空間マッピングによって使用されるカメラでは、ユーザーの前に 3.1 m しか表示されないことに注意してください。そのため、ユーザーが過去の距離を超えていない限り、空間マッピングは遠く離れたサーフェイスを認識しません。</span><span class="sxs-lookup"><span data-stu-id="83d79-140">Bear in mind however that the camera used by spatial mapping can only see 3.1m in front of the user, so spatial mapping will not know about any more distant surfaces unless the user has observed them from a closer distance in the past.</span></span>
   * <span data-ttu-id="83d79-141">スキャンされたサーフェイスをユーザーが理解できるように、アプリケーションはこの効果に対して視覚的なフィードバックを提供する必要があります。たとえば、仮想シャドウをスキャンしたサーフェイスにキャストすると、ユーザーがこれらのサーフェイスにホログラムを配置するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="83d79-141">So the user understands which surfaces have been scanned, the application should provide visual feedback to this effect, for example casting virtual shadows onto scanned surfaces may help the user place holograms on those surfaces.</span></span>
   * <span data-ttu-id="83d79-142">この場合、空間サーフェスオブザーバーの境界ボリュームは、各フレームを本文ロックされた[空間座標系](coordinate-systems.md)に更新して、ユーザーがフォローするようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-142">For this case, the spatial surface observer's bounding volumes should be updated each frame to a body-locked [spatial coordinate system](coordinate-systems.md), so that they follow the user.</span></span>

* <span data-ttu-id="83d79-143">**適切な場所の検索**</span><span class="sxs-lookup"><span data-stu-id="83d79-143">**Find a suitable location**</span></span>
   * <span data-ttu-id="83d79-144">アプリケーションは、特定の要件を持つ場所で使用するように設計されている場合があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-144">An application may be designed for use in a location with specific requirements.</span></span>
   * <span data-ttu-id="83d79-145">たとえば、アプリケーションでは、holographic kung-fu を安全に実行できるように、ユーザーの周囲に空の領域が必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-145">For example, the application may require an empty area around the user so they can safely practice holographic kung-fu.</span></span>
   * <span data-ttu-id="83d79-146">アプリケーションでは、特定の要件をユーザーに事前に伝え、視覚的なフィードバックを明確にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-146">Applications should communicate any specific requirements to the user up-front, and reinforce them with clear visual feedback.</span></span>
   * <span data-ttu-id="83d79-147">この例では、アプリケーションは必要な空の領域の範囲を視覚化し、このゾーン内の不要なオブジェクトの存在を視覚的に強調表示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-147">In this example, the application should visualize the extent of the required empty area and visually highlight the presence of any undesired objects within this zone.</span></span>
   * <span data-ttu-id="83d79-148">この場合、空間サーフェスのオブザーバーの境界ボリュームは、選択した場所でワールドロックの[空間座標系](coordinate-systems.md)を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-148">For this case, the spatial surface observer's bounding volumes should use a world-locked [spatial coordinate system](coordinate-systems.md) in the chosen location.</span></span>

* <span data-ttu-id="83d79-149">**サーフェイスの適切な構成を見つける**</span><span class="sxs-lookup"><span data-stu-id="83d79-149">**Find a suitable configuration of surfaces**</span></span>
   * <span data-ttu-id="83d79-150">アプリケーションでは、たとえば、2つの大規模なフラットな壁面の壁を作るために、特定のサーフェイスの構成が必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-150">An application may require a specific configuration of surfaces, for example two large, flat, opposing walls to create a holographic hall of mirrors.</span></span>
   * <span data-ttu-id="83d79-151">このような場合、アプリケーションでは、空間マッピングによって提供されるサーフェスを分析して適切なサーフェイスを検出し、ユーザーに対してユーザーに指示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-151">In such cases the application will need to analyze the surfaces provided by spatial mapping to detect suitable surfaces, and direct the user toward them.</span></span>
   * <span data-ttu-id="83d79-152">アプリケーションのサーフェイス分析が完全に信頼できない場合は、フォールバックオプションが必要です。</span><span class="sxs-lookup"><span data-stu-id="83d79-152">The user should have a fallback option if the application's surface analysis is not completely reliable.</span></span> <span data-ttu-id="83d79-153">たとえば、アプリケーションで入室がフラットな壁として誤って識別される場合、このエラーを修正するための簡単な方法が必要になります。</span><span class="sxs-lookup"><span data-stu-id="83d79-153">For example, if the application incorrectly identifies a doorway as a flat wall, the user needs a simple way to correct this error.</span></span>

* <span data-ttu-id="83d79-154">**環境の一部をスキャンする**</span><span class="sxs-lookup"><span data-stu-id="83d79-154">**Scan part of the environment**</span></span>
   * <span data-ttu-id="83d79-155">アプリケーションでは、ユーザーの指示に従って、環境の一部のみをキャプチャすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="83d79-155">An application may wish to only capture part of the environment, as directed by the user.</span></span>
   * <span data-ttu-id="83d79-156">たとえば、アプリケーションは部屋の一部をスキャンするので、ユーザーが販売する家具用に分類された holographic 広告を投稿することができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-156">For example, the application scans part of a room so the user may post a holographic classified ad for furniture they wish to sell.</span></span>
   * <span data-ttu-id="83d79-157">この場合、アプリケーションは、スキャン中にユーザーによって監視されているリージョン内の空間マッピングデータをキャプチャする必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-157">In this case, the application should capture spatial mapping data within the regions observed by the user during their scan.</span></span>

* <span data-ttu-id="83d79-158">**部屋全体をスキャンする**</span><span class="sxs-lookup"><span data-stu-id="83d79-158">**Scan the whole room**</span></span>
   * <span data-ttu-id="83d79-159">アプリケーションでは、ユーザーの背後にあるものも含め、現在の部屋にあるすべてのサーフェイスのスキャンが必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-159">An application may require a scan of all of the surfaces in the current room, including those behind the user.</span></span>
   * <span data-ttu-id="83d79-160">たとえば、ゲームでは、すべての方向から何百もの Lilliputians が発生した場合に、ユーザーを Gulliver のロールに配置することができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-160">For example, a game may put the user in the role of Gulliver, under siege from hundreds of tiny Lilliputians approaching from all directions.</span></span>
   * <span data-ttu-id="83d79-161">このような場合、アプリケーションは、現在の部屋に既にスキャンされているサーフェイスの数を判断し、大きなギャップを埋めるようにユーザーの宝石を誘導する必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-161">In such cases, the application will need to determine how many of the surfaces in the current room have already been scanned, and direct the user's gaze to fill in significant gaps.</span></span>
   * <span data-ttu-id="83d79-162">このプロセスの重要なのは、まだスキャンされていないサーフェイスをユーザーに明確にするための視覚的なフィードバックを提供することです。</span><span class="sxs-lookup"><span data-stu-id="83d79-162">The key to this process is providing visual feedback that makes it clear to the user which surfaces have not yet been scanned.</span></span> <span data-ttu-id="83d79-163">アプリケーションでは、[距離ベースのフォグ](https://msdn.microsoft.com/library/windows/desktop/bb173401%28v=vs.85%29.aspx)を使用して、空間マッピングサーフェイスでカバーされていない領域を視覚的に強調することができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-163">The application could for example use [distance-based fog](https://msdn.microsoft.com/library/windows/desktop/bb173401%28v=vs.85%29.aspx) to visually highlight regions that are not covered by spatial mapping surfaces.</span></span>

* <span data-ttu-id="83d79-164">**環境の初期スナップショットを取得する**</span><span class="sxs-lookup"><span data-stu-id="83d79-164">**Take an initial snapshot of the environment**</span></span>
   * <span data-ttu-id="83d79-165">アプリケーションでは、初期の "スナップショット" を取得した後、環境内のすべての変更を無視することができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-165">An application may wish to ignore all changes in the environment after taking an initial 'snapshot'.</span></span>
   * <span data-ttu-id="83d79-166">これは、ユーザーが作成した、環境の初期状態と密接に結び付いているデータの中断を回避するために適している場合があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-166">This may be appropriate to avoid disruption of user-created data that is tightly coupled to the initial state of the environment.</span></span>
   * <span data-ttu-id="83d79-167">この場合、アプリケーションは、スキャンが完了したら、初期状態で空間マッピングデータのコピーを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-167">In this case, the application should make a copy of the spatial mapping data in its initial state once the scan is complete.</span></span>
   * <span data-ttu-id="83d79-168">環境によってホログラムが正しく occluded されていない場合、アプリケーションは空間マッピングデータへの更新の受信を続行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-168">Applications should continue receiving updates to spatial mapping data if holograms are still to be correctly occluded by the environment.</span></span>
   * <span data-ttu-id="83d79-169">空間マッピングデータを継続的に更新することで、発生したすべての変更を視覚化することができ、環境の以前の状態と現在の状態の違いをユーザーに明確にすることができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-169">Continued updates to spatial mapping data also allow visualizing any changes that have occurred, clarifying to the user the differences between prior and present states of the environment.</span></span>

* <span data-ttu-id="83d79-170">**環境のユーザーが開始したスナップショットを取得する**</span><span class="sxs-lookup"><span data-stu-id="83d79-170">**Take user-initiated snapshots of the environment**</span></span>
   * <span data-ttu-id="83d79-171">アプリケーションでは、ユーザーによって指示された場合にのみ、環境の変更に応答する必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-171">An application may only wish to respond to environmental changes when instructed by the user.</span></span>
   * <span data-ttu-id="83d79-172">たとえば、ユーザーは、さまざまな瞬間にその場所をキャプチャすることにより、友人の複数の 3D ' statues ' を作成できます。</span><span class="sxs-lookup"><span data-stu-id="83d79-172">For example, the user could create multiple 3D 'statues' of a friend by capturing their poses at different moments.</span></span>

* <span data-ttu-id="83d79-173">**ユーザーが環境を変更できるようにする**</span><span class="sxs-lookup"><span data-stu-id="83d79-173">**Allow the user to change the environment**</span></span>
   * <span data-ttu-id="83d79-174">アプリケーションは、ユーザーの環境で行われた変更にリアルタイムで応答するように設計されている場合があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-174">An application may be designed to respond in real-time to any changes made in the user's environment.</span></span>
   * <span data-ttu-id="83d79-175">たとえば、curtain を描画したユーザーは、holographic play に対して "シーンの変更" をトリガーできます。</span><span class="sxs-lookup"><span data-stu-id="83d79-175">For example, the user drawing a curtain could trigger 'scene change' for a holographic play taking place on the other side.</span></span>

* <span data-ttu-id="83d79-176">**空間マッピングデータのエラーを回避するためのユーザーガイド**</span><span class="sxs-lookup"><span data-stu-id="83d79-176">**Guide the user to avoid errors in the spatial mapping data**</span></span>
   * <span data-ttu-id="83d79-177">アプリケーションでは、環境のスキャン中にユーザーにガイダンスを提供することができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-177">An application may wish to provide guidance to the user while they are scanning their environment.</span></span>
   * <span data-ttu-id="83d79-178">これにより、ユーザーは、sunlit のウィンドウやミラーを離れるなどして、[空間マッピングデータ内](spatial-mapping-design.md#what-influences-spatial-mapping-quality)の特定の種類のエラーを回避できます。</span><span class="sxs-lookup"><span data-stu-id="83d79-178">This can help the user to avoid certain kinds of [errors in the spatial mapping data](spatial-mapping-design.md#what-influences-spatial-mapping-quality), for example by staying away from sunlit windows or mirrors.</span></span>

<span data-ttu-id="83d79-179">注意すべきもう1つの詳細は、空間マッピングデータの "範囲" が無制限ではないことです。</span><span class="sxs-lookup"><span data-stu-id="83d79-179">One additional detail to be aware of is that the 'range' of spatial mapping data is not unlimited.</span></span> <span data-ttu-id="83d79-180">空間マッピングでは、大きなスペースの永続的なデータベースが構築されますが、ユーザーの周囲のサイズが制限された ' バブル ' では、アプリケーションでそのデータを使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="83d79-180">Whilst spatial mapping does build a permanent database of large spaces, it only makes that data available to applications in a 'bubble' of limited size around the user.</span></span> <span data-ttu-id="83d79-181">したがって、長い corridor の先頭から開始して、開始から十分な距離が得られない場合は、最終的に空間サーフェスが先頭に戻ることになります。</span><span class="sxs-lookup"><span data-stu-id="83d79-181">Thus if you start at the beginning of a long corridor and walk far enough away from the start, then eventually the spatial surfaces back at the beginning will disappear.</span></span> <span data-ttu-id="83d79-182">もちろん、これらのサーフェイスは、使用可能な空間マッピングデータから消滅した後で、アプリケーションにキャッシュすることで軽減できます。</span><span class="sxs-lookup"><span data-stu-id="83d79-182">You can of course mitigate this by caching those surfaces in your application after they have disappeared from the available spatial mapping data.</span></span>

## <a name="mesh-processing"></a><span data-ttu-id="83d79-183">メッシュ処理</span><span class="sxs-lookup"><span data-stu-id="83d79-183">Mesh processing</span></span>

<span data-ttu-id="83d79-184">これは、サーフェイス内の一般的なエラーの種類を検出し、必要に応じて空間マッピングデータをフィルター処理、削除、または変更するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="83d79-184">It may help to detect common types of errors in surfaces and to filter, remove or modify the spatial mapping data as appropriate.</span></span>

<span data-ttu-id="83d79-185">空間マッピングデータは、実際のサーフェイスにできるだけ忠実として使用することを想定しているので、どのような処理を適用しても、画面が "真実" からさらに変化することに注意してください。</span><span class="sxs-lookup"><span data-stu-id="83d79-185">Bear in mind that spatial mapping data is intended to be as faithful as possible to real-world surfaces, so any processing you apply risks shifting your surfaces further from the 'truth'.</span></span>

<span data-ttu-id="83d79-186">役に立つ可能性があるさまざまな種類のメッシュ処理の例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="83d79-186">Here are some examples of different types of mesh processing that you may find useful:</span></span>

* <span data-ttu-id="83d79-187">**穴の塗りつぶし**</span><span class="sxs-lookup"><span data-stu-id="83d79-187">**Hole filling**</span></span>
   * <span data-ttu-id="83d79-188">ダークマテリアルで作成された小さなオブジェクトがスキャンに失敗した場合、周囲のサーフェイスに穴が残されます。</span><span class="sxs-lookup"><span data-stu-id="83d79-188">If a small object made of a dark material fails to scan, it will leave a hole in the surrounding surface.</span></span>
   * <span data-ttu-id="83d79-189">穴はオクルージョンに影響します。ホログラムは、不透明な現実世界の表面に穴を表示できます。</span><span class="sxs-lookup"><span data-stu-id="83d79-189">Holes affect occlusion: holograms can be seen 'through' a hole in a supposedly opaque real-world surface.</span></span>
   * <span data-ttu-id="83d79-190">穴は raycasts に影響します。ユーザーがサーフェイスを操作するために raycasts を使用している場合、これらの光線が穴を通過することは望ましくありません。</span><span class="sxs-lookup"><span data-stu-id="83d79-190">Holes affect raycasts: if you are using raycasts to help users interact with surfaces, it may be undesirable for these rays to pass through holes.</span></span> <span data-ttu-id="83d79-191">軽減策の1つは、適切にサイズ設定されたリージョンをカバーする複数の raycasts のバンドルを使用することです。</span><span class="sxs-lookup"><span data-stu-id="83d79-191">One mitigation is to use a bundle of multiple raycasts covering an appropriately sized region.</span></span> <span data-ttu-id="83d79-192">これにより、"外れ値" の結果をフィルター処理して、1つの raycast が小さな穴を通過した場合でも、集計結果が引き続き有効になるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-192">This will allow you to filter 'outlier' results, so that even if one raycast passes through a small hole, the aggregate result will still be valid.</span></span> <span data-ttu-id="83d79-193">ただし、このアプローチには計算コストがかかることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="83d79-193">However, be aware that this approach comes at a computational cost.</span></span>
   * <span data-ttu-id="83d79-194">穴は物理的な衝突に影響します。物理シミュレーションによって制御されるオブジェクトは、床の穴を通過して失われる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-194">Holes affect physics collisions: an object controlled by physics simulation may drop through a hole in the floor and become lost.</span></span>
   * <span data-ttu-id="83d79-195">Surface メッシュでは、このような穴をアルゴリズムに塗りつぶすことができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-195">It is possible to algorithmically fill such holes in the surface mesh.</span></span> <span data-ttu-id="83d79-196">ただし、windows や doorways などの "実際のホール" が入力されないように、アルゴリズムを調整する必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-196">However, you will need to tune your algorithm so that 'real holes' such as windows and doorways do not get filled in.</span></span> <span data-ttu-id="83d79-197">' 実際のホール ' を ' 虚数穴 ' から確実に区別することは困難であるため、' size ' や ' 境界図形 ' などのさまざまなヒューリスティックを試してみる必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-197">It can be difficult to reliably differentiate 'real holes' from 'imaginary holes', so you will need to experiment with different heuristics such as 'size' and 'boundary shape'.</span></span>

* <span data-ttu-id="83d79-198">**Hallucination の削除**</span><span class="sxs-lookup"><span data-stu-id="83d79-198">**Hallucination removal**</span></span>
   * <span data-ttu-id="83d79-199">反射、明るいライト、およびオブジェクトの移動は、中程度の小さな残留物を維持することができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-199">Reflections, bright lights and moving objects can leave small lingering 'hallucinations' floating in mid-air.</span></span>
   * <span data-ttu-id="83d79-200">Hallucinations への影響の影響: Hallucinations は、他のホログラムの前に移動するダークシェイプとして表示されることがあります。</span><span class="sxs-lookup"><span data-stu-id="83d79-200">Hallucinations affect occlusion: hallucinations may become visible as dark shapes moving in front of and occluding other holograms.</span></span>
   * <span data-ttu-id="83d79-201">Hallucinations は raycasts に影響します。 raycasts を使用してユーザーがサーフェイスを操作できるようにする場合、これらの光線は、背後にある表面ではなく hallucination にヒットする可能性があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-201">Hallucinations affect raycasts: if you are using raycasts to help users interact with surfaces, these rays could hit a hallucination instead of the surface behind it.</span></span> <span data-ttu-id="83d79-202">穴の場合と同様に、1つの raycast ではなく多くの raycasts を使用することができますが、この場合も計算コストが発生します。</span><span class="sxs-lookup"><span data-stu-id="83d79-202">As with holes, one mitigation is to use many raycasts instead of a single raycast, but again this will come at a computational cost.</span></span>
   * <span data-ttu-id="83d79-203">Hallucinations は、物理的な衝突に影響を与えます。物理シミュレーションによって制御されるオブジェクトは、hallucination に対してスタックし、一見した領域の領域を移動できなくなる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-203">Hallucinations affect physics collisions: an object controlled by physics simulation may become stuck against a hallucination and be unable to move through a seemingly clear area of space.</span></span>
   * <span data-ttu-id="83d79-204">Surface メッシュからこのような hallucinations をフィルター処理できます。</span><span class="sxs-lookup"><span data-stu-id="83d79-204">It is possible to filter such hallucinations from the surface mesh.</span></span> <span data-ttu-id="83d79-205">ただし、穴の場合と同様に、照明とドアハンドルなどの実際の小さなオブジェクトが削除されないように、アルゴリズムを調整する必要があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-205">However, as with holes, you will need to tune your algorithm so that real small objects such as lamp-stands and door handles do not get removed.</span></span>

* <span data-ttu-id="83d79-206">**滑らかさ**</span><span class="sxs-lookup"><span data-stu-id="83d79-206">**Smoothing**</span></span>
   * <span data-ttu-id="83d79-207">空間マッピングは、実際の対応するものと比較して、粗いまたは "雑音" のように見える表面を返すことがあります。</span><span class="sxs-lookup"><span data-stu-id="83d79-207">Spatial mapping may return surfaces that appear to be rough or 'noisy' in comparison to their real-world counterparts.</span></span>
   * <span data-ttu-id="83d79-208">滑らかさは、物理的な衝突に影響します。フロアが粗い場合は、物理的にシミュレートされたゴルフボールが直線内でスムーズにロールすることはできません。</span><span class="sxs-lookup"><span data-stu-id="83d79-208">Smoothness affects physics collisions: if the floor is rough, a physically simulated golf ball may not roll smoothly across it in a straight line.</span></span>
   * <span data-ttu-id="83d79-209">滑らかさはレンダリングに影響します。表面が直接視覚化されている場合、表面法線の外観が影響を受けることがあり、' クリーン ' の外観が中断される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-209">Smoothness affects rendering: if a surface is visualized directly, rough surface normals can affect its appearance and disrupt a 'clean' look.</span></span> <span data-ttu-id="83d79-210">サーフェイスのレンダリングに使用されるシェーダー内の適切な光源とテクスチャを使用することによって、これを軽減することができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-210">It is possible to mitigate this by using appropriate lighting and textures in the shader that is used to render the surface.</span></span>
   * <span data-ttu-id="83d79-211">Surface メッシュでの粗さを滑らかにすることができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-211">It is possible to smooth out roughness in a surface mesh.</span></span> <span data-ttu-id="83d79-212">ただし、これにより、対応する実際のサーフェイスから離れた場所にサーフェイスがプッシュされる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-212">However, this may push the surface further away from the corresponding real-world surface.</span></span> <span data-ttu-id="83d79-213">近接性を維持することは、正確なホログラムオクルージョンを生成し、ユーザーが holographic サーフェイスとの正確で予測可能な相互作用を実現できるようにするために重要です。</span><span class="sxs-lookup"><span data-stu-id="83d79-213">Maintaining a close correspondence is important to produce accurate hologram occlusion, and to enable users to achieve precise and predictable interactions with holographic surfaces.</span></span>
   * <span data-ttu-id="83d79-214">コスメティックの変更のみが必要な場合は、頂点の位置を変更せずに頂点の法線を滑らかにするだけで十分な場合があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-214">If only a cosmetic change is required, it may be sufficient to smooth vertex normals without changing vertex positions.</span></span>

* <span data-ttu-id="83d79-215">**平面の検索**</span><span class="sxs-lookup"><span data-stu-id="83d79-215">**Plane finding**</span></span>
   * <span data-ttu-id="83d79-216">アプリケーションでは、空間マッピングによって提供されるサーフェイスに対して実行する必要のあるさまざまな形式の分析があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-216">There are many forms of analysis that an application may wish to perform on the surfaces provided by spatial mapping.</span></span>
   * <span data-ttu-id="83d79-217">単純な例の1つは、"平面検索" です。サーフェイスの境界領域、主に平面領域を識別します。</span><span class="sxs-lookup"><span data-stu-id="83d79-217">One simple example is 'plane finding'; identifying bounded, mostly-planar regions of surfaces.</span></span>
   * <span data-ttu-id="83d79-218">平面領域は、アプリケーションによって holographic コンテンツが自動的に配置される holographic のワークサーフェスとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="83d79-218">Planar regions can be used as holographic work-surfaces, regions where holographic content can be automatically placed by the application.</span></span>
   * <span data-ttu-id="83d79-219">平面領域では、ユーザーインターフェイスを制限して、ユーザーがニーズに最も合ったサーフェイスと対話できるようにします。</span><span class="sxs-lookup"><span data-stu-id="83d79-219">Planar regions can constrain the user interface, to guide users to interact with the surfaces that best suit their needs.</span></span>
   * <span data-ttu-id="83d79-220">平面領域は、LCD 画面、テーブル、ホワイトボードなどの機能オブジェクトに対応する holographic のために、実際の世界のように使用できます。</span><span class="sxs-lookup"><span data-stu-id="83d79-220">Planar regions can be used as in the real world, for holographic counterparts to functional objects such as LCD screens, tables or whiteboards.</span></span>
   * <span data-ttu-id="83d79-221">平面領域では、再生領域を定義して、videogame レベルの基礎を形成できます。</span><span class="sxs-lookup"><span data-stu-id="83d79-221">Planar regions can define play areas, forming the basis of videogame levels.</span></span>
   * <span data-ttu-id="83d79-222">平面領域を使用すると、仮想エージェントは、実際の人間が見ている可能性のあるフロアの領域を特定することで、実際の世界を移動できます。</span><span class="sxs-lookup"><span data-stu-id="83d79-222">Planar regions can aid virtual agents to navigate the real world, by identifying the areas of floor that real people are likely to walk on.</span></span>

## <a name="prototyping-and-debugging"></a><span data-ttu-id="83d79-223">プロトタイプとデバッグ</span><span class="sxs-lookup"><span data-stu-id="83d79-223">Prototyping and debugging</span></span>

### <a name="useful-tools"></a><span data-ttu-id="83d79-224">便利なツール</span><span class="sxs-lookup"><span data-stu-id="83d79-224">Useful tools</span></span>
* <span data-ttu-id="83d79-225">[Hololens エミュレーター](using-the-hololens-emulator.md)は、物理的な hololens にアクセスせずに空間マッピングを使用するアプリケーションを開発するために使用できます。</span><span class="sxs-lookup"><span data-stu-id="83d79-225">The [HoloLens emulator](using-the-hololens-emulator.md) can be used to develop applications using spatial mapping without access to a physical HoloLens.</span></span> <span data-ttu-id="83d79-226">これにより、hololens でのライブセッションをリアルな環境でシミュレートし、アプリケーションが通常使用するすべてのデータ (HoloLens モーション、空間座標系、空間マッピングメッシュなど) を使用することができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-226">It allows you to simulate a live session on a HoloLens in a realistic environment, with all of the data your application would normally consume, including HoloLens motion, spatial coordinate systems and spatial mapping meshes.</span></span> <span data-ttu-id="83d79-227">これを使用すると、信頼性のある反復可能な入力を提供できます。これは、問題をデバッグし、コードの変更を評価するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="83d79-227">This can be used to provide reliable, repeatable input, which can be useful for debugging problems and evaluating changes to your code.</span></span>
* <span data-ttu-id="83d79-228">シナリオを再現するには、ライブ HoloLens からネットワーク経由で空間マッピングデータをキャプチャし、それをディスクに保存して、後続のデバッグセッションで再利用します。</span><span class="sxs-lookup"><span data-stu-id="83d79-228">To reproduce a scenarios, capture spatial mapping data over the network from a live HoloLens, then save it to disk and reuse it in subsequent debugging sessions.</span></span>
* <span data-ttu-id="83d79-229">[Windows デバイスポータルの3d ビュー](using-the-windows-device-portal.md#3d-view)では、空間マッピングシステムを介して現在使用可能なすべての空間サーフェスを確認することができます。</span><span class="sxs-lookup"><span data-stu-id="83d79-229">The [Windows device portal 3D view](using-the-windows-device-portal.md#3d-view) provides a way to see all of the spatial surfaces currently available via the spatial mapping system.</span></span> <span data-ttu-id="83d79-230">これにより、アプリケーション内の空間サーフェスを比較する基準が提供されます。たとえば、不足しているか、間違った場所に表示されている空間サーフェスがあるかどうかを簡単に確認できます。</span><span class="sxs-lookup"><span data-stu-id="83d79-230">This provides a basis of comparison for the spatial surfaces inside your application; for example you can easily tell if any spatial surfaces are missing or are being displayed in the wrong place.</span></span>

### <a name="general-prototyping-guidance"></a><span data-ttu-id="83d79-231">プロトタイプの一般的なガイダンス</span><span class="sxs-lookup"><span data-stu-id="83d79-231">General prototyping guidance</span></span>
* <span data-ttu-id="83d79-232">空間マッピングデータの[エラー](spatial-mapping-design.md#what-influences-spatial-mapping-quality)はユーザーのエクスペリエンスに大きな影響を与える可能性があるため、さまざまな環境でアプリケーションをテストすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="83d79-232">Because [errors](spatial-mapping-design.md#what-influences-spatial-mapping-quality) in the spatial mapping data may strongly affect your user's experience, we recommend that you test your application in a wide variety of environments.</span></span>
* <span data-ttu-id="83d79-233">たとえば、机で同じ場所に常にテストするという習慣ではトラップされません。</span><span class="sxs-lookup"><span data-stu-id="83d79-233">Don't get trapped in the habit of always testing in the same location, for example at your desk.</span></span> <span data-ttu-id="83d79-234">さまざまな位置、形状、サイズ、およびマテリアルのさまざまなサーフェイスでテストを行うようにしてください。</span><span class="sxs-lookup"><span data-stu-id="83d79-234">Make sure to test on various surfaces of different positions, shapes, sizes and materials.</span></span>
* <span data-ttu-id="83d79-235">同様に、統合または記録されたデータはデバッグに役立ちますが、同じ少数のテストケースには依存しないようにしてください。</span><span class="sxs-lookup"><span data-stu-id="83d79-235">Similarly, while synthetic or recorded data can be useful for debugging, don't become too reliant upon the same few test cases.</span></span> <span data-ttu-id="83d79-236">これにより、より多様なテストが以前に検出された重要な問題を見つけることが遅れる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="83d79-236">This may delay finding important issues that more varied testing would have caught earlier.</span></span>
* <span data-ttu-id="83d79-237">実際のユーザー (および理想的には coached ではありません) でテストを実行することをお勧めします。これは、ユーザーが HoloLens またはアプリケーションをまったく同じ方法で使用しない可能性があるためです。</span><span class="sxs-lookup"><span data-stu-id="83d79-237">It is a good idea to perform testing with real (and ideally un-coached) users, because they may not use the HoloLens or your application in exactly the same way that you do.</span></span> <span data-ttu-id="83d79-238">実際には、異なるているユーザーの行動、知識、および前提条件はどのようになるかを驚かれるかもしれません。</span><span class="sxs-lookup"><span data-stu-id="83d79-238">In fact, it may surprise you how divergent people's behavior, knowledge and assumptions can be!</span></span>

## <a name="see-also"></a><span data-ttu-id="83d79-239">関連項目</span><span class="sxs-lookup"><span data-stu-id="83d79-239">See also</span></span>
* [<span data-ttu-id="83d79-240">部屋のスキャンの可視化</span><span class="sxs-lookup"><span data-stu-id="83d79-240">Room scan visualization</span></span>](room-scan-visualization.md)
* [<span data-ttu-id="83d79-241">立体音響の設計</span><span class="sxs-lookup"><span data-stu-id="83d79-241">Spatial sound design</span></span>](spatial-sound-design.md)
* [<span data-ttu-id="83d79-242">Unity の永続化</span><span class="sxs-lookup"><span data-stu-id="83d79-242">Persistence in Unity</span></span>](persistence-in-unity.md)
